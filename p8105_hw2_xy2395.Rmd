---
title: "p8105_hw2_xy2395"
author: "Jack Yan"
date: "9/27/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# devtools::install_github("p8105/p8105.datasets")
data(package = 'p8105.datasets',  brfss_smart2010)
```

# Problem 1

## Data import and manipulation

```{r echo=T, eval = F}
data_nysubway = 
  read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(-division, -exit_only, -(staffing:staff_hours), -(ada_notes:entrance_location)) %>% 
  mutate( entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
```

```{r, include = FALSE}
data_nysubway = 
  read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(-division, -exit_only, -(staffing:staff_hours), -(ada_notes:entrance_location)) %>% 
  mutate( entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
```

The code above imported data from the `.csv` file, and cleaned up variable names using `clean_names` function. It also selected variables to be used from the original dataset. Further, it converted the entry variable from character (`YES` vs `NO`) to a logical variable. Now the dataset contains variables of line, station name, station latitude & longitude, routes served, entrance type, entry, vending, and ADA compliance. Now the dataset has `r nrow(data_nysubway)` rows (observations) and  `r ncol(data_nysubway)` columns (variables). The data are not yet tidy, because the routes that each station supports are spead along variables from route1 to route11. I will fix this problem in Question 4.

A datailed list of variables in this dataset is shown below:

```{r}
names(data_nysubway)
```


## Questions

### Question 1

```{r}
data_nysubway = mutate(data_nysubway, station_name_line = paste(station_name, line) )
distinct_station_name_line = distinct(data_nysubway, station_name_line)
nrow(distinct_station_name_line)
```

There are `r nrow(distinct_station_name_line)` stations.

### Question 2
```{r}
data_nysubway %>% 
  filter(ada == TRUE) %>% 
  distinct(station_name_line) %>% 
  nrow()
```

There are 84 ADA compliant stations.

### Question 3
```{r}
n_without_vending =
  data_nysubway %>% 
  filter( vending == "NO") %>% 
  nrow()

n_without_vending_allow_entrance = 
  data_nysubway %>% 
  filter( vending == "NO") %>% 
  filter( entry == TRUE) %>% 
  nrow()

n_without_vending_allow_entrance / n_without_vending
```

The proportion of station entrances / exits without vending allow entrance is `r round(n_without_vending_allow_entrance / n_without_vending, 2)`.

### Question 4

Use `gather` to tidy the data so that each value in the previous variables (from `route1` to `route11`) is gathered into a new variable `route_served`. Then filter out `NA`s and delete the unnecessary `route_number` variable.

```{r}
tidy_data_nysubway = 
  gather(data_nysubway, key = route_number, value = route_served, route1:route11) %>% 
  filter(route_served != 'NA') %>% 
  select(-route_number)

tidy_data_nysubway %>% 
  filter(route_served == "A") %>% 
  distinct(station_name_line) %>% 
  nrow()

tidy_data_nysubway %>% 
  filter(route_served == "A") %>% 
  filter(ada == TRUE) %>% 
  distinct(station_name_line) %>% 
  nrow()
```

There are 60 distinct stations serving the A train, and 17 of them are ADA compliant.

# Problem 2
```{r}

```

